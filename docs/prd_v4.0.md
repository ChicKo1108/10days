# 《十日计划》产品需求文档 PRD V4.0 
本次更新：补全**底部Tab栏**、完整页面归属、长卷-篇章全流程跳转、AI拆解细则、结算页后续逻辑、修改权限边界，补齐V4.0所有缺失信息，UI/UX与程序逻辑1:1落地。

## 1. 文档信息
- 版本号：V4.0
- 更新日志：新增底部Tab栏定义；明确长卷/篇章层级关系；补全所有页面跳转逻辑；完善结算页后续自动规划规则；细化篇章创建/修改权限；统一全流程交互链路；补齐所有UI展示与操作细节。
- 适用平台：微信小程序（前端）+ Express.js & PostgreSQL（后端）
- 视觉风格：新中式水墨（宣纸底色、墨迹洇染、朱砂印章）

## 2. 产品背景 & 目标
- 业务核心：解决长线计划高放弃率问题，以**10天1篇章**为最小坚持单元，通过书童（AI）动态拆解目标，结合水墨视觉反馈，降低坚持门槛。
- 核心KPI：篇章完赛率、长卷续期率、复盘分享率

## 3. 用户分析
- 目标用户：长期主义者、考证/技能学习人群、极简/国风审美爱好者
- 核心痛点：目标太大无从下手、坚持无正向反馈、突发情况导致断更

## 4. 功能架构（按Tab优先级）
### 底部Tab核心模块
1. 【篇章】Tab（首页·十日阵地）—— 当日执行入口
2. 【长卷】Tab —— 总目标全景管理
3. 【我】Tab —— 个人中心

### 功能闭环
- P0 核心：长卷创建 → AI拆篇章 → 每日打卡/留白 → 10天结算 → 长卷续期/完赛
- P1 管理：历史记录查看、未来篇章修改、笔记回顾
- P2 辅助：个人信息、账号注销

## 5. 核心概念定义（开发&UI统一口径）
- **长卷**：用户总目标（如：30天读书、60天健身），由N个**10天篇章**组成
- **篇章**：长卷下最小执行单元，固定10天
- **墨迹**：单天的具体任务内容
- **盖章**：当日任务完成打卡
- **留白**：当日跳过打卡（豁免机会）

## 6. 全局业务总流程
1. 用户创建长卷 → 输入总目标+总天数 → 书童（AI）自动拆分为N个10天篇章 → 自动生成前2个篇章内容 → 用户手动调整 | 用户创建篇章 → 输入篇章目标 → 书童（AI）根据目标拆分10天篇章内容 → 用户手动调整
2. 进入【篇章】Tab执行当日任务 → 盖章/留白 → 记录笔记
3. 完成10天篇章 → 进入结算页回顾
4. 若长卷未完成：检查后续篇章是否规划 → 无规划则书童（AI）自动生成并跳转篇章创建/修改页 → 确认后继续循环
5. 若长卷完成：生成终期完赛内容
6. 可在【长卷】Tab查看历史篇章、修改未来篇章

## 7. 核心规则（程序逻辑不可变）
### 7.1 书童（AI）「1+3」拆解规则
- 1个基础目标：10天每日重复执行（如：每日阅读20分钟）
- 3个进阶阶段目标：第1-3天（入门）、4-6天（进阶）、7-9天（突破）
- 第10天：固定为复盘回顾

### 7.2 留白规则
- 每个篇章仅3次留白机会
- 仅可对**当天**使用留白
- 使用后当日标记留白，不扣达成率，不改变时间轴
- 不可对过去日期使用留白

### 7.3 任务修改规则
- 已进行的天数、当天天数：**禁止修改**
- 仅可对**未来未开始的篇章/天数**进行修改
- 修改入口：长卷详情页 → 未来篇章

### 7.4 结算后续规则
- 结算页展示10天任务+用户所有记录
- 若为长卷中篇章：自动校验后续篇章规划
- 后续篇章无规划：自动跳转篇章创建/修改页，AI按当前进度自动填充内容

## 8. 底部Tab栏（全局固定）
共3个Tab，小程序底部常驻：
1. 篇章（首页·十日阵地）
2. 长卷
3. 我

## 9. 全量页面详细说明（无缺失·1:1还原UI/UX）
### 9.1 Tab1：【篇章】页（十日阵地·首页）
- 归属：底部Tab第一个页面
- 展示内容：
  1. 标题：十日阵地
  2. 列表：所有进行中的篇章列表项
  3. 列表项信息：长远目标名称、进度表（已完成/当前天/未完成）、今日目标
- 交互：
  1. 点击列表项 → 进入「篇章详情页」
  2. 页面内创建按钮 → 进入「长卷/篇章创建页」
- 权限：所有用户可见自己的内容

### 9.2 篇章详情页
- 入口：篇章Tab列表项点击进入
- 展示内容：
  1. 顶部：10天进度条
  2. 中部：当前选中天数的「墨迹」（任务内容）、笔记输入框（记录进度/感想）
  3. 底部：盖章按钮、留白按钮
  4. 长卷信息入口：展示所属长卷信息，点击跳转「长卷详情页」
- 交互：
  1. 点击进度条任意天数 → 切换展示对应天数墨迹
  2. 当天：可点击盖章/留白，可编辑笔记
  3. 非当天：仅查看，不可操作
  4. 第10天点击盖章 → 直接跳转「结算篇章页」

### 9.3 长卷详情页
- 归属：底部Tab第二个页面
- 展示内容：
  1. 已执行完成的篇章列表
  2. 当前进行中的篇章
  3. 未来剩余的篇章
- 交互：
  1. 点击已执行篇章 → 跳转篇章详情页（只读查看历史记录）
  2. 点击未来篇章 → 进入「篇章创建/修改页」
  3. 展示长卷总目标、总天数、总篇章数

### 9.4 篇章创建/修改页
- 入口：长卷详情页（未来篇章）、结算页自动跳转
- 功能：
  1. AI自动拆解：1个基础目标+3阶段进阶目标
  2. 用户可自由编辑任务内容
- 约束：
  1. 仅可修改**未进行的天数**
  2. 已进行、当天不可修改
- 操作：点击确定 → 保存规划 → 返回对应页面

### 9.5 长卷创建页
- 入口：篇章Tab（十日阵地）创建按钮
- 流程：
  1. 输入总目标计划 + 总天数
  2. AI自动拆解为N个10天篇章
  3. AI自动生成**前2个篇章**的详细内容
  4. 确认创建 → 生成长卷+篇章 → 跳转篇章Tab

### 9.6 结算篇章页
- 入口：篇章详情页第10天盖章完成
- 展示内容：
  1. 10天全部计划目标回顾
  2. 用户所有记录笔记
  3. 所属长卷的当前+历史篇章进度
- 后续逻辑：
  1. 长卷未完成 → 检查后续篇章是否有规划
  2. 无规划 → 自动跳转篇章创建/修改页，书童（AI）按进度自动填充内容
  3. 长卷完成 → 展示终期完赛内容

### 9.7 Tab3：【我】页（个人中心）
- 归属：底部Tab第三个页面
- 展示内容：
  1. 个人头像、昵称等个人信息
  2. 账号注销按钮
  3. 基础设置入口
- 交互：仅查看与基础操作，无业务逻辑

## 10. 非功能需求
- 视觉：新中式水墨，宣纸底色、墨迹洇染、朱砂印章
- 交互：页面切换淡入淡出/横向卷轴拉伸，盖章震动+木头敲击音效
- 性能：AI生成加载展示水墨Loading，文案：「正在为您裁切篇章」「墨迹润色中」
- 数据：PostgreSQL（Master_Plans、Quests表结构沿用）

## 11. 数据指标 & 埋点
- 打卡时长埋点：用户盖章长按时长
- AI重规划次数：用户修改AI生成计划次数
- 海报生成次数：完赛海报生成次数
- 留白使用次数：统计用户留白豁免使用情况

## 12. 风险与备注
- 所有日期判断以服务器时间为准，避免客户端时间异常
- 篇章修改仅开放未来天数，防止历史数据错乱
- 长卷自动拆分篇章时，总天数不足10天按1个篇章计算