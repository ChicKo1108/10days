<view class="container">
  <!-- 固定头部：日期与标题 -->
  <view class="fixed-header anim-fade-in">
    <view class="header-content">
      <text class="date font-sans text-gray">二月廿五 · 今日</text>
      <text class="title font-song">十日阵地</text>
      <view class="ink-line"></view>
    </view>
  </view>

  <!-- 列表内容 -->
  <scroll-view scroll-y class="content anim-fade-in" style="animation-delay: 0.2s;">
    <!-- 列表项：使用卡片封装 -->
    <block wx:if="{{quests.length > 0}}">
      <paper-card wx:for="{{quests}}" wx:key="id" bindtap="goToDetail" data-id="{{item.id}}">
        <view class="quest-item">
          <view class="quest-info">
            <text class="quest-title font-song">{{item.title}}</text>
            <text class="quest-subtitle font-sans text-gray" wx:if="{{item.planTitle}}">长卷：{{item.planTitle}}</text>
          </view>
          <!-- 进度条展示 (水墨点) -->
          <view class="progress-dots">
            <!-- progress: 0-pending, 1-completed, 2-skipped -->
            <view 
              class="dot {{p === 1 ? 'completed' : (p === 2 ? 'skipped' : (index === item.currentDay - 1 ? 'active' : 'pending'))}}" 
              wx:for="{{item.progress}}" 
              wx:for-item="p" 
              wx:key="index">
            </view>
          </view>
        </view>
        <view class="quest-daily font-song text-ink">
          <text class="bullet">●</text> 今日：{{item.dailyTask}}
        </view>
      </paper-card>
    </block>
    
    <!-- 空状态 -->
    <view wx:else class="empty-state font-song text-gray">
      <text>暂无进行中的篇章，点击右下角开启</text>
    </view>
    
    <!-- 底部留白 -->
    <view class="footer-spacer"></view>
  </scroll-view>

  <!-- 底部悬浮按钮 -->
  <view class="fab-container anim-fade-in" style="animation-delay: 0.4s;">
    <view class="fab-btn" bindtap="goToCreate">
      <text class="plus-icon font-song">+</text> 
      <text class="fab-text font-song">新篇章</text>
    </view>
  </view>
</view>
